MERGE [dbo].[GptInteractions] WITH (HOLDLOCK) AS t
USING (SELECT @PromptHash AS PromptHash) AS s
ON (t.PromptHash = s.PromptHash)
WHEN MATCHED THEN
    UPDATE SET
        Response  = @Response,
        CreatedAt = SYSUTCDATETIME(),
        Active    = 1
WHEN NOT MATCHED THEN
    INSERT (Prompt, PromptHash, Response, CreatedAt, Active)
    VALUES (@Prompt, @PromptHash, @Response, SYSUTCDATETIME(), 1);










































































































































































    --// Copyrigtht (c) 2025 Citizen Hackathon https://github.com/POLLESSI/Citizenhackathon2025.API. All rights reserved.